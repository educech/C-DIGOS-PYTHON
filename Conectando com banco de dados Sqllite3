import tkinter as tk
import sqlite3 
import pandas as pd

#CRIAR O BANCO

#conexao = sqlite3.connect("Banco.Clientes.db")
#cursor = conexao.cursor()

#CRIAR TABELA

#cursor.execute('''create table clientes (
 # nome text,
 # sobrenome text,
 # email text,
 # telefone text
 #  )
# ''')
#conexao.commit()
#conexao.close()
# COMENTAR CRIAÇÃO DO BANCO PARA NÃO CRIAR OUTRO BANCO

#CRIAR FUNÇÃO CADASTRAR CLIENTE
def cadastrar_cliente():

    conexao = sqlite3.connect("Banco.Clientes.db")

    cursor = conexao.cursor()

    cursor.execute("insert into clientes values( :nome, :sobrenome, :email, :telefone)",

        {
            'nome':entry_nome.get(),
            'sobrenome':entry_sobrenome.get(),
            'email':entry_email.get(),
            'telefone':entry_telefone.get()
        }   
      )

    conexao.commit()
    conexao.close()

#APAGANDO DADOS DO CAMPO JANELA DEPOIS DE CADASTRADOS
    entry_nome.delete(0, "end")
    entry_sobrenome.delete(0, "end")
    entry_email.delete(0, "end")
    entry_telefone.delete(0, "end")
    

#CRIAR FUNÇÃO EXPORTAR CLIENTE
def exportar_cliente():
    conexao = sqlite3.connect("Banco.Clientes.db")
    cursor = conexao.cursor()

#CRIAR TABELA

    cursor.execute("sELECT *, oid from clientes")
    clientes_cadastrados = cursor.fetchall()
    clientes_cadastrados = pd.DataFrame(clientes_cadastrados, columns=['nome', 'sobrenome', 'email', 'telefone', 'id_banco'])
    clientes_cadastrados.to_csv('banco_clientes.xlsx')
    conexao.commit()
    conexao.close()



# Criar a interface gráfica
janela = tk.Tk()
janela.title("Ferramaneta de cadastro de clientes")

# campos
# label
label_nome = tk.Label(janela, text="Nome")
label_nome.grid(row=0, column=0, padx=10, pady=10)

label_sobrenome = tk.Label(janela, text="Sobrenome")
label_sobrenome.grid(row=1, column=0, padx=10, pady=10)

label_email= tk.Label(janela, text="Email")
label_email.grid(row=2, column=0, padx=10, pady=10)

label_telefone = tk.Label(janela, text="Telefone")
label_telefone.grid(row=3, column=0, padx=10, pady=10)

#entry
entry_nome = tk.Entry(janela, text="Nome", width=30)
entry_nome.grid(row=0, column=1, padx=10, pady=10)

entry_sobrenome = tk.Entry(janela, text="Sobrenome", width=30)
entry_sobrenome.grid(row=1, column=1, padx=10, pady=10)

entry_email= tk.Entry(janela, text="Email", width=30)
entry_email.grid(row=2, column=1, padx=10, pady=10)


entry_telefone = tk.Entry(janela, text="Telefone", width=30)
entry_telefone.grid(row=3, column=1, padx=10, pady=10)


# botão cadastrar
botao_cadastrar = tk.Button(janela, text="Cadastrar Cliente", command=cadastrar_cliente)
botao_cadastrar.grid(row=4, column=0, padx=10, pady=10, columnspan=2, ipadx=80)

# botão exportar
botao_exportar = tk.Button(janela, text="Exportar base de clientes", command=exportar_cliente)
botao_exportar.grid(row=5, column=0, padx=10, pady=10, columnspan=2, ipadx=80)

janela.mainloop()





